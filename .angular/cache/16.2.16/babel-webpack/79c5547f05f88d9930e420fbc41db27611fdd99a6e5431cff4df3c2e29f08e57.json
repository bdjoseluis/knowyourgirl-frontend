{"ast":null,"code":"import { FormBuilder, FormArray, Validators } from '@angular/forms';\nimport { GrupoService } from '../services/email.service'; // Renombrado\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"../services/email.service\";\nimport * as i3 from \"@angular/common\";\nfunction GroupFormComponent_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 7)(1, \"h3\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\")(4, \"label\");\n    i0.ɵɵtext(5, \"Nombre\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(6, \"input\", 2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\")(8, \"label\");\n    i0.ɵɵtext(9, \"Descripci\\u00F3n\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(10, \"input\", 8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"div\")(12, \"label\");\n    i0.ɵɵtext(13, \"Ciudad (opcional)\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(14, \"input\", 9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"div\")(16, \"label\");\n    i0.ɵɵtext(17, \"Edad (opcional)\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(18, \"input\", 10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"button\", 5);\n    i0.ɵɵlistener(\"click\", function GroupFormComponent_div_9_Template_button_click_19_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r4);\n      const i_r2 = restoredCtx.index;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.removeMember(i_r2));\n    });\n    i0.ɵɵtext(20, \"Eliminar miembro\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const i_r2 = ctx.index;\n    i0.ɵɵproperty(\"formGroupName\", i_r2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Miembro \", i_r2 + 1, \"\");\n  }\n}\nexport let GroupFormComponent = /*#__PURE__*/(() => {\n  class GroupFormComponent {\n    constructor(fb, grupoService) {\n      this.fb = fb;\n      this.grupoService = grupoService;\n      // Definimos el formulario con los nombres internos que prefieras\n      this.form = this.fb.group({\n        name: ['', Validators.required],\n        members: this.fb.array([])\n      });\n    }\n    ngOnInit() {\n      this.addMember();\n    }\n    get members() {\n      return this.form.get('members');\n    }\n    addMember() {\n      this.members.push(this.fb.group({\n        name: ['', Validators.required],\n        description: [''],\n        city: [''],\n        age: ['']\n      }));\n    }\n    removeMember(index) {\n      if (this.members.length > 1) this.members.removeAt(index);\n    }\n    submit() {\n      if (this.form.invalid) {\n        this.form.markAllAsTouched();\n        return;\n      }\n      const raw = this.form.value;\n      /**\n       * IMPORTANTE: Aquí mapeamos los datos para que coincidan\n       * exactamente con tus entidades de Spring Boot (Grupo y Persona)\n       */\n      const payload = {\n        nombre: raw.name,\n        personas: (raw.members || []).map(m => ({\n          nombre: m.name,\n          descripcion: m.description || '',\n          ciudad: m.city || '',\n          edad: m.age ? Number(m.age) : 0 // En Java: 'edad'\n        }))\n      };\n      // Llamamos al nuevo servicio que apunta al puerto 8087\n      this.grupoService.saveGroup(payload).subscribe({\n        next: response => {\n          console.log('Respuesta del servidor:', response);\n          alert('¡Grupo y miembros guardados con éxito en la base de datos!');\n          this.resetForm();\n        },\n        error: err => {\n          console.error(err);\n          alert('Error al conectar con Spring Boot: ' + (err.error?.message || err.message));\n        }\n      });\n    }\n    resetForm() {\n      this.form.reset();\n      this.members.clear();\n      this.addMember();\n    }\n    static {\n      this.ɵfac = function GroupFormComponent_Factory(t) {\n        return new (t || GroupFormComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.GrupoService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: GroupFormComponent,\n        selectors: [[\"app-group-form\"]],\n        decls: 14,\n        vars: 2,\n        consts: [[1, \"container\"], [3, \"formGroup\", \"ngSubmit\"], [\"formControlName\", \"name\", \"required\", \"\"], [\"formArrayName\", \"members\"], [\"class\", \"member\", 3, \"formGroupName\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"button\", 3, \"click\"], [\"type\", \"submit\"], [1, \"member\", 3, \"formGroupName\"], [\"formControlName\", \"description\"], [\"formControlName\", \"city\"], [\"formControlName\", \"age\", \"type\", \"number\"]],\n        template: function GroupFormComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\");\n            i0.ɵɵtext(2, \"Crear Grupo\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(3, \"form\", 1);\n            i0.ɵɵlistener(\"ngSubmit\", function GroupFormComponent_Template_form_ngSubmit_3_listener() {\n              return ctx.submit();\n            });\n            i0.ɵɵelementStart(4, \"div\")(5, \"label\");\n            i0.ɵɵtext(6, \"Nombre del grupo\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(7, \"input\", 2);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(8, \"div\", 3);\n            i0.ɵɵtemplate(9, GroupFormComponent_div_9_Template, 21, 2, \"div\", 4);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(10, \"button\", 5);\n            i0.ɵɵlistener(\"click\", function GroupFormComponent_Template_button_click_10_listener() {\n              return ctx.addMember();\n            });\n            i0.ɵɵtext(11, \"A\\u00F1adir miembro\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(12, \"button\", 6);\n            i0.ɵɵtext(13, \"Guardar\");\n            i0.ɵɵelementEnd()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(3);\n            i0.ɵɵproperty(\"formGroup\", ctx.form);\n            i0.ɵɵadvance(6);\n            i0.ɵɵproperty(\"ngForOf\", ctx.members.controls);\n          }\n        },\n        dependencies: [i3.NgForOf, i1.ɵNgNoValidate, i1.DefaultValueAccessor, i1.NumberValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.RequiredValidator, i1.FormGroupDirective, i1.FormControlName, i1.FormGroupName, i1.FormArrayName],\n        encapsulation: 2\n      });\n    }\n  }\n  return GroupFormComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}